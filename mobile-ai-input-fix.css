/* AI聊天输入框修复 - 微信风格设计 */

/* ===== 强制显示输入框容器 ===== */
#ai-page .chat-input-container {
    /* 强制显示 */
    display: flex !important;
    visibility: visible !important;
    opacity: 1 !important;

    /* 固定在底部 */
    position: fixed !important;
    bottom: 60px !important;
    /* 为底部导航栏留出空间 */
    left: 0 !important;
    right: 0 !important;
    z-index: 1000 !important;

    /* 全宽布局 */
    width: 100vw !important;
    max-width: none !important;
    margin: 0 !important;

    /* 内边距 */
    padding: 12px 16px !important;

    /* 适配安全区域 */
    padding-bottom: calc(12px + env(safe-area-inset-bottom)) !important;

    /* 背景与毛玻璃效果 */
    background: rgba(255, 255, 255, 0.95) !important;
    backdrop-filter: blur(20px) !important;
    -webkit-backdrop-filter: blur(20px) !important;

    /* 顶部分割线 */
    border-top: 0.5px solid rgba(0, 0, 0, 0.1) !important;

    /* 阴影效果 */
    box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.05) !important;

    /* 防止收缩 */
    flex-shrink: 0 !important;
}

/* ===== 输入包装器 ===== */
#ai-page .input-wrapper {
    /* 强制显示 */
    display: flex !important;
    visibility: visible !important;
    opacity: 1 !important;

    /* 弹性布局 */
    align-items: center !important;
    gap: 12px !important;

    /* 全宽 */
    width: 100% !important;
    max-width: none !important;
    margin: 0 !important;
}

/* ===== 消息输入框 - 微信风格 ===== */
#ai-page .message-input {
    /* 强制显示 */
    display: block !important;
    visibility: visible !important;
    opacity: 1 !important;

    /* 占据剩余空间 */
    flex: 1 !important;

    /* 高度 */
    height: 40px !important;
    min-height: 40px !important;
    max-height: 120px !important;

    /* 内边距 */
    padding: 0 16px !important;

    /* 圆角 */
    border-radius: 20px !important;

    /* 边框 */
    border: 1px solid #e0e0e0 !important;

    /* 背景 */
    background: #f5f5f5 !important;

    /* 文字样式 */
    font-size: 16px !important;
    color: #333 !important;
    line-height: 20px !important;

    /* 移除轮廓 */
    outline: none !important;

    /* 过渡动画 */
    transition: all 0.2s ease !important;

    /* 文本换行 */
    word-wrap: break-word !important;
    overflow-y: auto !important;
    resize: none !important;
}

#ai-page .message-input:focus {
    background: white !important;
    border-color: #07c160 !important;
    box-shadow: 0 0 0 2px rgba(7, 193, 96, 0.2) !important;
}

#ai-page .message-input::placeholder {
    color: #999 !important;
    font-size: 16px !important;
}

/* ===== 发送按钮 - 微信风格 ===== */
#ai-page .send-button {
    /* 强制显示 */
    display: flex !important;
    visibility: visible !important;
    opacity: 1 !important;

    /* 固定尺寸 */
    width: 40px !important;
    height: 40px !important;
    min-width: 40px !important;
    min-height: 40px !important;

    /* 圆形 */
    border-radius: 20px !important;

    /* 背景 */
    background: #07c160 !important;
    border: none !important;

    /* 文字样式 */
    color: white !important;
    font-size: 16px !important;

    /* 弹性布局居中 */
    align-items: center !important;
    justify-content: center !important;

    /* 过渡动画 */
    transition: all 0.2s ease !important;

    /* 点击样式 */
    cursor: pointer !important;

    /* 防止收缩 */
    flex-shrink: 0 !important;
}

#ai-page .send-button:hover {
    background: #06ad56 !important;
    transform: scale(1.05) !important;
}

#ai-page .send-button:active {
    background: #059748 !important;
    transform: scale(0.95) !important;
}

#ai-page .send-button:disabled {
    background: #c8c8c8 !important;
    cursor: not-allowed !important;
    transform: none !important;
}

/* 发送图标 */
#ai-page .send-icon {
    font-size: 18px !important;
    color: white !important;
    line-height: 1 !important;
}

/* ===== 暗色模式适配 ===== */
[data-theme="dark"] #ai-page .chat-input-container,
body.dark-theme #ai-page .chat-input-container {
    background: rgba(0, 0, 0, 0.95) !important;
    border-top-color: rgba(255, 255, 255, 0.1) !important;
}

[data-theme="dark"] #ai-page .message-input,
body.dark-theme #ai-page .message-input {
    background: #2a2a2a !important;
    border-color: #444 !important;
    color: white !important;
}

[data-theme="dark"] #ai-page .message-input:focus,
body.dark-theme #ai-page .message-input:focus {
    background: #3a3a3a !important;
    border-color: #07c160 !important;
}

[data-theme="dark"] #ai-page .message-input::placeholder,
body.dark-theme #ai-page .message-input::placeholder {
    color: #888 !important;
}

/* ===== 响应式适配 ===== */
@media (max-width: 375px) {
    #ai-page .chat-input-container {
        padding: 10px 12px !important;
        padding-bottom: calc(10px + env(safe-area-inset-bottom)) !important;
    }

    #ai-page .message-input {
        height: 36px !important;
        min-height: 36px !important;
        font-size: 16px !important;
        /* 防止iOS缩放 */
        padding: 0 14px !important;
    }

    #ai-page .send-button {
        width: 36px !important;
        height: 36px !important;
        min-width: 36px !important;
        min-height: 36px !important;
    }

    #ai-page .send-icon {
        font-size: 16px !important;
    }
}

@media (min-width: 414px) {
    #ai-page .chat-input-container {
        padding: 14px 20px !important;
        padding-bottom: calc(14px + env(safe-area-inset-bottom)) !important;
    }

    #ai-page .message-input {
        height: 44px !important;
        min-height: 44px !important;
        font-size: 17px !important;
        padding: 0 18px !important;
    }

    #ai-page .send-button {
        width: 44px !important;
        height: 44px !important;
        min-width: 44px !important;
        min-height: 44px !important;
    }

    #ai-page .send-icon {
        font-size: 18px !important;
    }
}

/* ===== 动画效果 ===== */
#ai-page .message-input:focus {
    animation: inputFocus 0.3s ease !important;
}

@keyframes inputFocus {
    0% {
        transform: scale(1);
    }

    50% {
        transform: scale(1.01);
    }

    100% {
        transform: scale(1);
    }
}

#ai-page .send-button.sending {
    animation: sendPulse 0.6s ease !important;
}

@keyframes sendPulse {
    0% {
        transform: scale(1);
    }

    50% {
        transform: scale(1.1);
        box-shadow: 0 0 20px rgba(7, 193, 96, 0.4);
    }

    100% {
        transform: scale(1);
    }
}

/* ===== 性能优化 ===== */
#ai-page .chat-input-container,
#ai-page .input-wrapper,
#ai-page .message-input,
#ai-page .send-button {
    /* 硬件加速 */
    transform: translateZ(0) !important;
    will-change: transform !important;
    backface-visibility: hidden !important;
}

/* ===== 触摸优化 ===== */
#ai-page .message-input,
#ai-page .send-button {
    /* 触摸目标最小尺寸 */
    min-height: 44px !important;

    /* 触摸反馈 */
    -webkit-tap-highlight-color: transparent !important;
    touch-action: manipulation !important;
}

/* ===== 确保输入框不被其他样式覆盖 ===== */
#ai-page .chat-input-container * {
    box-sizing: border-box !important;
}

/* 防止其他CSS文件隐藏输入框 */
#ai-page .chat-input-container,
#ai-page .input-wrapper,
#ai-page .message-input,
#ai-page .send-button {
    display: flex !important;
    visibility: visible !important;
    opacity: 1 !important;
    pointer-events: auto !important;
}

#ai-page .message-input {
    display: block !important;
}
